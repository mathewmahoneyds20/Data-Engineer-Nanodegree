
CREATE OR replace VIEW forestation AS
SELECT r.country_name,
       r.country_code,
       r.region,
       r.income_group,
       f.year,
       f.forest_area_sqkm,
       f.forest_area_sqkm / 2.59 AS forest_area_sq_mi,
       la.total_area_sq_mi,
       la.total_area_sq_mi * 2.59 AS total_area_sqkm,
       (f.forest_area_sqkm / (la.total_area_sq_mi * 2.59)) * 100 AS percent_forest
FROM regions r
INNER JOIN forest_area f ON r.country_code = f.country_code
INNER JOIN land_area la ON f.country_code = la.country_code AND f.year = la.year
ORDER BY year, country_name




SELECT ROUND(forest_area_sqkm) AS forest_area_sqkm1990
FROM forestation
WHERE country_code= 'WLD' AND year = 1990;



41282695



SELECT ROUND(forest_area_sqkm) AS forest_area_sqkm1990
FROM forestation
WHERE country_code= 'WLD' AND year = 2016;



39958246



SELECT region, ROUND(MAX(percent_forest))
FROM forestation
WHERE year = 2016
GROUP BY 1
ORDER BY 2 DESC
LIMIT 1;

Latin America & Caribbean	98 %

SELECT region, ROUND(forest_area_sqkm)
FROM forestation
WHERE region = 'World' AND  year = 1990

41282695 sqkm

SELECT region, ROUND(MAX(percent_forest))
FROM forestation
WHERE year = 1990
GROUP BY 1
ORDER BY 2 DESC
LIMIT 1;

SELECT country_name, "1990", "2016", ROUND("2016"-"1990") AS forest_change,  (("2016" - "1990")/"1990")*100 AS percent
FROM (SELECT
MAX(case when (year = 1990) then forest_area_sqkm else NULL end) as "1990",
MAX(case when (year = 2016) then forest_area_sqkm else NULL end) as "2016", country_name
FROM forestation
GROUP BY country_name
) sub

ORDER BY percent, forest_change, "2016" ASC;


SELECT region, ROUND(SUM(forest_area_sqkm))/(SUM(total_area_sqkm)) * 100 AS percent , year
FROM forestation f
WHERE year in (1990, 2016)
GROUP BY 1 , f.year
ORDER BY region;

-------latin america totals0-----
SELECT region, SUM(forest_area_sqkm)/SUM(total_area_sqkm), year
FROM forestation
WHERE region = 'Latin America & Caribbean' AND year = 2016
GROUP BY 1,3;

Latin America & Caribbean	9250586	20039364	2016



SELECT region, SUM(forest_area_sqkm)/SUM(total_area_sqkm) * 100 AS percent , year1990, year2016
FROM forestation f
WHERE year1990 = 1990 AND year2016 = 2016
GROUP BY 1 , f.year
ORDER BY year;


SELECT country_name, "1990", "2016", ROUND("2016"-"1990") AS forest_change,  (("2016" - "1990")/"1990")*100 AS percent,country_name
FROM (SELECT
MAX(case when (year = 1990) then forest_area_sqkm else NULL end) as "1990",
MAX(case when (year = 2016) then forest_area_sqkm else NULL end) as "2016", country_name, region
FROM forestation
GROUP BY country_name
) sub

ORDER BY percent, forest_change, "2016" ASC;



SELECT percent_forest, country_name AS country,
CASE
    WHEN percent_forest <= 25 THEN 4
    WHEN percent_forest <= 50 THEN 3
    WHEN percent_forest <= 75 THEN 2
    ELSE 1
END AS quartile
FROM forestation;